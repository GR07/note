你不会发布订阅模式，你还配做前端吗？

# 发布订阅

+ 有两件事 发布 和 订阅

+ 当需要等异步队列执行完成后做一些指定事情时，可以选用发布订阅

+ 发布 和 订阅 之间没有任何关系，通过中间层进行关联


# 案例

promise 、 redux 、vue 生命周期 都是通过发布订阅实现的

```js
const fs = require('fs');

// 中间代理层
function Event() {
    this.callBack = [];
    this.data = []
}

// 订阅 就是收集函数 同步
Event.prototype.on = function (callBack) {
    this.callBack.push(callBack)
}

// 发布 就是依次执行收集的函数 异步
Event.prototype.emit = function (data) {
    this.data.push(data)
    this.callBack.forEach((c) => c(this.data))
}

const e = new Event();

e.on(function (arr) {
    if (arr.length === 2) {
        console.log(`函数1`);
    }
})
e.on(function (arr) {
    if (arr.length === 2) {
        console.log(`函数2`);
    }
})
e.on(function (arr) {
    if (arr.length === 2) {
        console.log(`函数3`);
    }
})

// 异步任务
fs.readFile('./a.txt', 'utf8', function (err, data) {
    e.emit(data)
})
// 异步任务
fs.readFile('./b.txt', 'utf8', function (err, data) {
    e.emit(data)
})
```