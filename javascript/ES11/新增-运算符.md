更新ing：https://juejin.im/post/5d9bf530518825427b27639d#heading-47


# 空值合并运算符 ??

?? 是一个逻辑操作符，当左侧的操作数为 null 或者 undefined，返回其右侧操作数，否则返回左侧操作数。


```js
const foo = undefined ?? "foo"
const bar = null ?? "bar"
console.log(foo) // foo
console.log(bar) // bar
```


- 和 || 不同点
```js
// 和 || 操作符不同的是，|| 操作符会在左侧操作数为 假 时 返回右侧操作数。
// 也就是说，如果使用 || 来为某些变量设置默认值，可能会遇到意料之外的行为。
// 例如 '', 0, NaN, false 
const foo = "" ?? 'default string';
const foo2 = "" || 'default string';
console.log(foo); // ""
console.log(foo2); // "default string"

const baz = 0 ?? 42;
const baz2 = 0 || 42;
console.log(baz); // 0
console.log(baz2); // 42
```


- 注意 将 ?? 直接与 AND（&&）和 OR（||）操作符组合使用是不可取的。

```js
null || undefined ?? "foo"; // 抛出 SyntaxError
true || undefined ?? "foo"; // 抛出 SyntaxError
```




# 可选链运算符 ?.

- 允许读取位于对象链深处的属性，而不必明确验证每个属性是否有效。

- 功能类似于 . 链式操作符，不同在于，在引用为 null 或者 undefined 的情况下不会引起错误，该表达式短路返回值是 undefined。

- 与函数调用一起使用时，如果给定的函数不存在，则返回 undefined。



```javascript
// 比如，要读取message.body.user.firstName，安全的写法是写成下面这样。
const firstName = (message
  && message.body
  && message.body.user
  && message.body.user.firstName) || 'default';
```


这样的层层判断非常麻烦，因此 ES2020 引入了“链判断运算符”

```javascript
const firstName = message?.body?.user?.firstName || 'default';
const fooValue = myForm.querySelector('input[name=foo]')?.value
```

链判断运算符有三种用法：

```javascript
obj?.prop // 对象属性
obj?.[expr] // 同上
func?.(...args) // 函数或对象方法的调用

iterator.return?.() // 如果有定义就调用该方法，否则返回undefined
```

空判断操作符(??)：

|| 存在一个问题属性的值如果为空字符串或false或0，默认值也会生效。

?? 值为undefined或null，则使用默认值

```js
const a = {b: 0};
const b = a?.b || 'def'; // "def"
const c = a?.b ?? "dff" // 0
```