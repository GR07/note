# 需求

要在两个仓库之间迁移代码文件或文件夹，并保留 Git 历史记录。

# 下载 git-filter-repo

git-filter-repo 就是一个 python 脚本

pip install git-filter-repo

# 操作

1. 克隆源仓库

git clone <源仓库 URL>
cd <源仓库目录>

2. 过滤要迁移的文件或文件夹

git-filter-repo --path src/

这个命令将重写历史记录，只保留对 src/ 文件夹的更改。

示例
git-filter-repo --subdirectory-filter flow-form/hr/overtime-application-new/

执行命令后，就只保留了 flow-form/hr/overtime-application-new/ 下的文件了

这么多文件夹，我只需要迁移 HR 相关的 oa 流程申请，所以借助 git-filter-repo 的另一个命令

git-filter-repo --path <文件夹名称> ，可以执行多个 —path

3. 改目录结构

将这两个文件夹 推到 HR 仓库，那将会合到根目录，肯定是不对的，如果要丝滑合到的对应的目标仓库的远程仓库目录，那我们就要构造和目标仓库一样目录结构。

我们将克隆仓库过滤后剩下的文件改造成和 hr 目录结构一致.

4. 重命名目录

所以还得使用 git-filter-repo 的另一个命令 git-filter-repo --path-rename :<文件夹名称>/

这样，现在的本地文件目录结构和即将合并的 HR 仓库目标文件夹是一致了。

5. 添加目标仓库作为远程仓库

切换到源仓库的本地副本中，添加目标仓库 HR 仓库作为一个新的远程：

p.s. 此处我将别名设置为 target

git remote add target <目标仓库 URL>

6. 推送到目标仓库

把代码推送到了 HR 仓库中的 xx 分支中

git push target <本地分支名>:<目标分支名>

# tip: 至此本地代码的 flow 仓库操作结束。此时需要去 HR 仓库去操作。
